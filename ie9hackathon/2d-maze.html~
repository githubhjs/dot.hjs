<!doctype html> 
<html> 
<head> 
<meta charset="UTF-8" /> 

</head> 
<body> 
<header> </header> 
<nav> </nav> 
<section> 

<div> 
<canvas id="canvas" width="482" height="482"> 
This text is displayed if your browser does not support HTML5 Canvas. 
</canvas> 
</div> 

<script type="text/javascript"> 


var canvas; 
var ctx; 
var dx = 5; 
var dy = 5; 
var x = 200; 
var y = 5; 
var WIDTH = 482; 
var HEIGHT = 482; 
var img = new Image(); 
var collision = 0; 

function rect(x,y,w,h) { 
ctx.beginPath(); 
ctx.rect(x,y,w,h); 
ctx.closePath(); 
ctx.fill(); 
} 

function clear() { 
ctx.clearRect(0, 0, WIDTH, HEIGHT); 
ctx.drawImage(img, 0, 0); 
} 

function init() { 
canvas = document.getElementById("canvas"); 
ctx = canvas.getContext("2d"); 
img.src = "maze.gif"; 
return setInterval(draw, 10); 
} 

function doKeyDown(evt){ 
switch (evt.keyCode) { 
case 87: /* Up */ 
if (y - dy > 0){ 
y -= dy; 
clear(); 
checkcollision(); 
if (collision == 1){ 
y += dy; 
collision = 0; 
} 
} 

break; 
case 83: /* Down */ 
if (y + dy < HEIGHT ){ 
y += dy; 
clear(); 
checkcollision(); 
if (collision == 1){ 
y -= dy; 
collision = 0; 
} 
} 

break; 
case 65: /* Left */ 
if (x - dx > 0){ 
x -= dx; 
clear(); 
checkcollision(); 
if (collision == 1){ 
x += dx; 
collision = 0; 
} 
} 
break; 
case 68: /* Right */ 
if ((x + dx < WIDTH)){ 
x += dx; 
clear(); 
checkcollision(); 
if (collision == 1){ 
x -= dx; 
collision = 0; 
} 
} 
break; 
} 
} 

function checkcollision() { 
var imgd = ctx.getImageData(x, y, 15, 15); 
var pix = imgd.data; 
for (var i = 0; n = pix.length, i < n; i += 4) { 
if (pix[i] == 0) { 
collision = 1; 
} 
} 
} 

function draw() { 
clear(); 
ctx.fillStyle = "purple"; 
rect(x, y, 15,15); 
} 

init(); 
var dumpimgd;
for (var x = 0; n = pix.length, i < n; i += 1) { 
        for (var y = 0; n = pix.length, y < n; y += 1) { 
                dumpimgd[x+y] = ctx.getImageData(x, y, 1, 1); 
        }
}
window.addEventListener('keydown',doKeyDown,true); 
</script> 
</section> 
<aside> </aside> 
<footer> </footer> 
</body> 
</html> 

