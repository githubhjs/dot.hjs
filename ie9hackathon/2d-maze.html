<!doctype html> 
<html> 
<head> 
<meta charset="UTF-8" /> 

</head> 
<body> 
<header> </header> 
<nav> </nav> 
<section> 

<div> 
<canvas id="canvas" width="482" height="482"> 
This text is displayed if your browser does not support HTML5 Canvas. 
</canvas> 
</div> 

<script type="text/javascript"> 
// A // // a 32x24 block map
// A // var map = [
// A //   [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
// A //   [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
// A //   [1,0,0,2,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
// A //   [1,0,0,2,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
// A //   [1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
// A //   [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
// A //   [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
// A // ];
// A // var mapWidth = 0;  // number of map blocks in x-direction
// A // var mapHeight = 0;  // number of map blocks in y-direction
// A // var miniMapScale = 8;  // how many pixels to draw a map block
// A // 
// A // function init() {
// A //   mapWidth = map[0].length;
// A //   mapHeight = map.length;
// A // 
// A //   drawMiniMap();
// A // }
// A // 
// A // 
// A // function drawMiniMap() {
// A //   // draw the topdown view minimap
// A //   var miniMap = $("minimap");
// A //   miniMap.width = mapWidth * miniMapScale;  // resize the internal canvas dimensions 
// A //   miniMap.height = mapHeight * miniMapScale;
// A //   miniMap.style.width = (mapWidth * miniMapScale) + "px";  // resize the canvas CSS dimensions
// A //   miniMap.style.height = (mapHeight * miniMapScale) + "px";
// A // 
// A //   // loop through all blocks on the map
// A //   var ctx = miniMap.getContext("2d");
// A //   for (var y=0;y<mapHeight;y++) {
// A //     for (var x=0;x<mapWidth;x++) {
// A //       var wall = map[y][x];
// A //       if (wall > 0) {  // if there is a wall block at this (x,y) ...
// A //         ctx.fillStyle = "rgb(200,200,200)";
// A //         ctx.fillRect(  // ... then draw a block on the minimap
// A //           x * miniMapScale,
// A //           y * miniMapScale,
// A //           miniMapScale,miniMapScale
// A //         );
// A //       }
// A //     }
// A //   }
// A // }


var canvas; 
var ctx; 
var dx = 5; 
var dy = 5; 
var x = 200; 
var y = 5; 
var WIDTH = 482; 
var HEIGHT = 482; 
var img = new Image(); 
var collision = 0; 

function rect(x,y,w,h) { 
ctx.beginPath(); 
ctx.rect(x,y,w,h); 
ctx.closePath(); 
ctx.fill(); 
} 

function clear() { 
ctx.clearRect(0, 0, WIDTH, HEIGHT); 
ctx.drawImage(img, 0, 0); 
} 

function init() { 
canvas = document.getElementById("canvas"); 
ctx = canvas.getContext("2d"); 
img.src = "maze.gif"; 
return setInterval(draw, 10); 
} 

function doKeyDown(evt){ 
switch (evt.keyCode) { 
case 87: /* Up */ 
if (y - dy > 0){ 
y -= dy; 
clear(); 
checkcollision(); 
if (collision == 1){ 
y += dy; 
collision = 0; 
} 
} 

break; 
case 83: /* Down */ 
if (y + dy < HEIGHT ){ 
y += dy; 
clear(); 
checkcollision(); 
if (collision == 1){ 
y -= dy; 
collision = 0; 
} 
} 

break; 
case 65: /* Left */ 
if (x - dx > 0){ 
x -= dx; 
clear(); 
checkcollision(); 
if (collision == 1){ 
x += dx; 
collision = 0; 
} 
} 
break; 
case 68: /* Right */ 
if ((x + dx < WIDTH)){ 
x += dx; 
clear(); 
checkcollision(); 
if (collision == 1){ 
x -= dx; 
collision = 0; 
} 
} 
break; 
} 
} 

function checkcollision() { 
var imgd = ctx.getImageData(x, y, 15, 15); 
var pix = imgd.data; 
for (var i = 0; n = pix.length, i < n; i += 4) { 
if (pix[i] == 0) { 
collision = 1; 
} 
} 
} 

function draw() { 
clear(); 
ctx.fillStyle = "purple"; 
rect(x, y, 15,15); 
} 

init(); 
window.addEventListener('keydown',doKeyDown,true); 
</script> 
</section> 
<aside> </aside> 
<footer> </footer> 
</body> 
</html> 

